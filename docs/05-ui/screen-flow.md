# 화면 흐름도

## 1. 개요

VOC 자동 처리 시스템의 화면 구성과 네비게이션 흐름을 정의한다.

### 1.1 POC 화면 목적

> POC 화면의 목적은 협업툴 대체가 아니다.
> 목적은 오직 하나: **"Agent 판단을 사람이 신뢰할 수 있는가?"**

---

## 2. 화면 구성

### 2.1 화면 목록

| 화면 | 경로 | 설명 |
|------|------|------|
| VOC 입력 | `/voc/new` | VOC 텍스트 입력 폼 |
| Ticket 목록 | `/tickets` | 전체 Ticket 목록 조회 |
| Ticket 상세 | `/tickets/:id` | Ticket 정보 및 Agent 분석 결과 |

### 2.2 화면 구조

```
┌─────────────────────────────────────────────────────────┐
│  Header (네비게이션)                                     │
├─────────────────────────────────────────────────────────┤
│                                                         │
│                    Main Content                         │
│                                                         │
│                                                         │
└─────────────────────────────────────────────────────────┘
```

---

## 3. 네비게이션 흐름

### 3.1 메인 흐름

```
┌────────────┐      ┌──────────────┐      ┌───────────────┐
│  VOC 입력  │─────▶│ Ticket 목록  │─────▶│ Ticket 상세   │
└────────────┘      └──────────────┘      └───────────────┘
      │                    ▲                     │
      │                    │                     │
      └────────────────────┴─────────────────────┘
                    (어디서든 이동 가능)
```

### 3.2 상세 흐름도

```
[VOC 입력 화면]
     │
     │ VOC 제출
     ▼
[Ticket 생성 완료]
     │
     ├─── 성공 ──────────────────────┐
     │                               │
     │ 정규화 실패                    │
     ▼                               ▼
[MANUAL_REQUIRED]              [ANALYZING]
     │                               │
     │ 수동 완료                      │ Agent 분석 완료
     ▼                               ▼
  [DONE]                    [WAITING_CONFIRM]
                                    │
                    ┌───────────────┼───────────────┐
                    │               │               │
                    ▼               ▼               ▼
                [DONE]        [REJECTED]      [ANALYZING]
               (Approve)       (Reject)        (Retry)
```

---

## 4. 화면별 상세

### 4.1 VOC 입력 화면 (`/voc/new`)

#### 목적
VOC 원문과 부가 정보를 입력한다.

#### 레이아웃

```
┌─────────────────────────────────────────────────────────┐
│  VOC 입력                                         [목록] │
├─────────────────────────────────────────────────────────┤
│                                                         │
│  고객명 *                                               │
│  ┌─────────────────────────────────────────────────┐   │
│  │                                                 │   │
│  └─────────────────────────────────────────────────┘   │
│                                                         │
│  접수 채널 *                                            │
│  ○ Email    ○ Slack                                    │
│                                                         │
│  접수 일시 *                                            │
│  ┌─────────────────────────────────────────────────┐   │
│  │ 2024-01-15T09:30:00                             │   │
│  └─────────────────────────────────────────────────┘   │
│                                                         │
│  VOC 내용 *                                             │
│  ┌─────────────────────────────────────────────────┐   │
│  │                                                 │   │
│  │ (텍스트 입력 영역)                               │   │
│  │                                                 │   │
│  │                                                 │   │
│  └─────────────────────────────────────────────────┘   │
│                                                         │
│                                       [ VOC 제출 ]      │
│                                                         │
└─────────────────────────────────────────────────────────┘
```

#### 기능
- 필수 필드 검증
- 제출 시 Ticket 생성
- 성공 시 Ticket 상세로 이동

---

### 4.2 Ticket 목록 화면 (`/tickets`)

#### 목적
전체 Ticket을 조회하고 필터링한다.

#### 레이아웃

```
┌─────────────────────────────────────────────────────────┐
│  Ticket 목록                                   [VOC 입력]│
├─────────────────────────────────────────────────────────┤
│                                                         │
│  필터: [상태 ▼] [긴급도 ▼]              정렬: [최신순 ▼] │
│                                                         │
│  ┌─────────────────────────────────────────────────────┐│
│  │ 🔴 VOC-20240115-0001                                ││
│  │ 결제 API 타임아웃으로 인한 결제 실패                 ││
│  │ 상태: WAITING_CONFIRM  신뢰도: 85%  긴급: high       ││
│  │ 2024-01-15 09:30                                    ││
│  └─────────────────────────────────────────────────────┘│
│                                                         │
│  ┌─────────────────────────────────────────────────────┐│
│  │ 🟡 VOC-20240115-0002                                ││
│  │ 환불 요청 시 에러 발생                               ││
│  │ 상태: ANALYZING  긴급: medium                        ││
│  │ 2024-01-15 10:15                                    ││
│  └─────────────────────────────────────────────────────┘│
│                                                         │
│  ┌─────────────────────────────────────────────────────┐│
│  │ 🟢 VOC-20240115-0003                                ││
│  │ 결제 취소 버튼 위치 문의                             ││
│  │ 상태: DONE  긴급: low                                ││
│  │ 2024-01-15 11:00                                    ││
│  └─────────────────────────────────────────────────────┘│
│                                                         │
│  < 1 2 3 ... 10 >                                       │
│                                                         │
└─────────────────────────────────────────────────────────┘
```

#### 상태별 시각적 표시

| 상태 | 색상 | 아이콘 |
|------|------|--------|
| OPEN | 회색 | ⚪ |
| ANALYZING | 파란색 | 🔵 (또는 로딩) |
| WAITING_CONFIRM | 주황색 | 🟠 |
| DONE | 초록색 | 🟢 |
| MANUAL_REQUIRED | 빨간색 | 🔴 |
| REJECTED | 검정색 | ⚫ |

#### 기능
- 상태 필터링 (다중 선택 가능)
- 긴급도 필터링
- 정렬 (생성일시, 긴급도)
- 페이지네이션
- 항목 클릭 시 상세로 이동

---

### 4.3 Ticket 상세 화면 (`/tickets/:id`)

#### 목적
Ticket 정보, Agent 분석 결과를 확인하고 관리자 액션을 수행한다.

#### 레이아웃

```
┌─────────────────────────────────────────────────────────┐
│  ← Ticket 목록        VOC-20240115-0001                 │
├─────────────────────────────────────────────────────────┤
│                                                         │
│  ┌─────────────────────────────────────────────────────┐│
│  │ 상태: WAITING_CONFIRM           긴급도: 🔴 high     ││
│  │ 생성: 2024-01-15 09:30          분석 완료: 09:31    ││
│  └─────────────────────────────────────────────────────┘│
│                                                         │
│  ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ │
│  📝 VOC 원문                                            │
│  ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ │
│  고객명: 김철수 | 채널: email | 접수: 2024-01-15 09:30  │
│  ┌─────────────────────────────────────────────────────┐│
│  │ 어제 밤에 카드 결제를 했는데 PG사에서 결제 실패     ││
│  │ 문자가 왔어요. 근데 제 카드에서는 빠져나갔거든요?   ││
│  │ 이거 확인 좀 해주세요.                              ││
│  └─────────────────────────────────────────────────────┘│
│                                                         │
│  ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ │
│  🤖 Agent 분석 결과                      신뢰도: 85% 🟢 │
│  ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ │
│                                                         │
│  문제 유형: integration_error (연동사 오류)             │
│  영향 시스템: PG결제시스템                              │
│                                                         │
│  📋 요약                                                │
│  ┌─────────────────────────────────────────────────────┐│
│  │ 외부 결제 API 타임아웃으로 인한 결제 실패           ││
│  └─────────────────────────────────────────────────────┘│
│                                                         │
│  ✅ 판단 근거                                           │
│  • 2024-01-15 14:32:01 - PaymentGateway 응답 12.3초    │
│  • 내부 로직 정상 완료 후 외부 호출 단계에서 실패       │
│  • 최근 7일간 동일 패턴 3건 발생                        │
│                                                         │
│  ❌ 제외된 가능성                                       │
│  • 내부 코드 오류: Exception 없음                       │
│  • 비즈니스 로직 문제: 요청 파라미터 유효성 통과        │
│                                                         │
│  ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ │
│  💡 제안 액션: 연동사 문의                              │
│  ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ │
│  대상: PaymentGateway (partner-support@pg.com)          │
│                                                         │
│  [메일 초안 보기 ▼]                                     │
│  ┌─────────────────────────────────────────────────────┐│
│  │ 제목: [문의] 결제 API 타임아웃 증가 현상            ││
│  │ ─────────────────────────────────────────────────   ││
│  │ 안녕하세요,                                         ││
│  │                                                     ││
│  │ 귀사 결제 API 호출 시 타임아웃이 발생하고 있어      ││
│  │ 문의드립니다...                                     ││
│  └─────────────────────────────────────────────────────┘│
│                                                         │
│  ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ │
│  관리자 액션                                            │
│  ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ │
│                                                         │
│     [ ✓ 승인 ]    [ ✗ 거부 ]    [ ↻ 재분석 ]           │
│                                                         │
└─────────────────────────────────────────────────────────┘
```

#### 신뢰도 표시

| 신뢰도 | 색상 | 레이블 |
|--------|------|--------|
| 80%+ | 🟢 초록 | 높은 신뢰도 |
| 60~80% | 🟡 노랑 | 중간 신뢰도 |
| 60% 미만 | 🔴 빨강 | 낮은 신뢰도 (MANUAL_REQUIRED) |

#### 액션별 동작

| 액션 | 동작 | 추가 입력 |
|------|------|-----------|
| 승인 | Ticket 완료 처리 | 없음 |
| 거부 | 거부 사유 모달 표시 → 종료 | 사유 필수 |
| 재분석 | Agent 재분석 시작 | 없음 |

---

## 5. 상태별 화면 분기

### 5.1 Ticket 상세 화면 분기

| 상태 | 표시 내용 | 가능 액션 |
|------|-----------|-----------|
| OPEN | "분석 대기 중" | 없음 |
| ANALYZING | "분석 중..." + 로딩 | 없음 |
| WAITING_CONFIRM | Agent 분석 결과 전체 | 승인, 거부, 재분석 |
| DONE | 처리 완료 정보 | 없음 (읽기 전용) |
| MANUAL_REQUIRED | "수동 처리 필요" 안내 | 수동 완료 |
| REJECTED | 거부 사유 표시 | 없음 (읽기 전용) |

### 5.2 MANUAL_REQUIRED 화면

```
┌─────────────────────────────────────────────────────────┐
│  ⚠️ 수동 처리 필요                                      │
│                                                         │
│  Agent가 이 VOC를 자동으로 분석하지 못했습니다.         │
│  수동으로 확인 후 처리 결과를 입력해주세요.             │
│                                                         │
│  사유: 신뢰도 부족 (confidence: 0.45)                   │
│                                                         │
│  처리 결과 입력                                         │
│  ┌─────────────────────────────────────────────────────┐│
│  │                                                     ││
│  │ (처리 내용 입력)                                    ││
│  │                                                     ││
│  └─────────────────────────────────────────────────────┘│
│                                                         │
│                                     [ 수동 처리 완료 ]  │
│                                                         │
└─────────────────────────────────────────────────────────┘
```

---

## 6. 거부 사유 모달

```
┌─────────────────────────────────────────────────────────┐
│  VOC 거부                                          [×]  │
├─────────────────────────────────────────────────────────┤
│                                                         │
│  거부 사유를 입력해주세요. *                            │
│                                                         │
│  ┌─────────────────────────────────────────────────────┐│
│  │                                                     ││
│  │ (거부 사유 입력)                                    ││
│  │                                                     ││
│  └─────────────────────────────────────────────────────┘│
│                                                         │
│                           [ 취소 ]    [ 거부 확인 ]     │
│                                                         │
└─────────────────────────────────────────────────────────┘
```

---

## 7. 반응형 고려

### 7.1 브레이크포인트

| 크기 | 너비 | 레이아웃 |
|------|------|----------|
| Desktop | 1024px+ | 전체 레이아웃 |
| Tablet | 768~1023px | 축소 레이아웃 |
| Mobile | ~767px | POC 범위 외 |

### 7.2 POC 기준

- Desktop 우선 개발
- Tablet은 기본 지원
- Mobile은 POC 범위 외
